<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:composite="http://java.sun.com/jsf/composite"
	xmlns:middleware="http://java.sun.com/jsf/composite/middleware"
	xmlns:rich="http://richfaces.org/rich">

<composite:interface>
	<composite:attribute name="type" required="true"
		type="org.genericsystem.api.core.Generic" />
	<composite:attribute name="instances" required="true"
		type="java.util.List" />
	<!-- <composite:attribute name="add"
		method-signature="void action(org.genericsystem.api.core.Generic)" />  -->
	<composite:attribute name="getTargets" />
	<composite:attribute name="hasTarget" type="boolean" />
	<composite:attribute name="editable" type="boolean" />
</composite:interface>

<composite:implementation>
	<h:outputLabel value="#{cc.attrs.type.value}" />
	<rich:dataTable value="#{cc.attrs.instances}" var="instance">

		<h:column>
			<h:inputText value="#{linkListForm.getWrapperModify(instance).value}"
				rendered="#{cc.attrs.editable}" />
			<h:outputText value="#{instance.value}"
				rendered="#{not cc.attrs.editable}" />
		</h:column>
		<c:forEach varStatus="cpt"
			items="${linksList.getCompositionComponentsList(cc.attrs.type)}">
			<h:column>
				<h:outputText value="#{instance.getCompositionComponent(cpt.index)}" />
			</h:column>
		</c:forEach>
		<!-- 
		<h:column>
			<rich:panel rendered="#{linksList.hasTarget(generic)}">
				<h:selectOneMenu
					value="#{linkListForm.getWrapperModify(generic).target}"
					rendered="#{cc.attrs.editable}" converter="genericConverter">
					<f:selectItems
						value="#{linksList.getTargetItems(cc.attrs.iterableGeneric)}" />
				</h:selectOneMenu>
				<h:outputText value="#{generic.getTargetComponent()}"
					rendered="#{not cc.attrs.editable}" />
			</rich:panel>
		</h:column>
 -->
		<h:column rendered="#{cc.attrs.editable}">
			<h:commandButton
				action="#{linksList.modifyValue(instance, cc.attrs.type)}"
				value="Save" />
			<br />
		</h:column>
		<h:column>
			<h:commandButton action="#{linksList.delete(instance)}" value="X" />
		</h:column>
		<f:facet name="footer">
			<h:inputText
				value="#{linkListForm.getWrapperAdd(cc.attrs.type).value}" />
			<h:selectOneMenu
				value="#{linkListForm.getWrapperAdd(cc.attrs.type).target}"
				rendered="#{cc.attrs.hasTarget}" converter="genericConverter">
				<f:selectItems value="#{cc.attrs.getTargets}" />
			</h:selectOneMenu>
			<h:commandButton action="#{linksList.newInstance(cc.attrs.type)}" value="Add" />
		</f:facet>

	</rich:dataTable>
</composite:implementation>

</html>