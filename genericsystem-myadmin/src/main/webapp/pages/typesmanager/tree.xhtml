<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:gs="http://java.sun.com/jsf/composite/gs">
	<h:outputStylesheet>
		.rf-ind-drag.default {
	        background-position: 5px;
	        background-repeat: no-repeat;
	        border: 2px solid red;
	        padding: 5px;
	        background-color: #EB9A99;
        }
        .rf-ind-drag.accept {
	        background-position: 5px;
	        background-repeat: no-repeat;
	        border: 2px solid green;
        }
        .rf-ind-drag.reject {
	        background-position: 5px;
	        background-repeat: no-repeat;
	        border: 2px solid red;
	    }
	</h:outputStylesheet>

	<rich:panel id="paneltypesmanager" layout="block"
		styleClass="widthScroll280 fullHeight">
		<f:facet name="header">
			<h:outputText value="#{msg.show} #{msg.implicits}"
				styleClass="capitalize bold" />
			<h:selectBooleanCheckbox value="#{genericTreeBean.implicitShow}"
				title="#{msg.show} #{msg.implicits}" style="vertical-align: middle;">
				<a4j:ajax event="change" render="typestree" />
			</h:selectBooleanCheckbox>
			<h:outputText value="#{msg.lockSelection}"
				styleClass="bold" />
			<h:selectBooleanCheckbox value="#{genericTreeBean.selectionLocked}"
				title="#{msg.lockSelection}" style="vertical-align: middle;">
				<a4j:ajax event="change" render="typestree" />
			</h:selectBooleanCheckbox>
		</f:facet>

		<script type="text/javascript">
			function menuTypes() {
				var panelPosX = #{rich:element('paneltypesmanager')}.getBoundingClientRect().left + document.body.scrollLeft +document.documentElement.scrollLeft;
				var panelPosY = #{rich:element('paneltypesmanager')}.getBoundingClientRect().top + document.body.scrollTop +document.documentElement.scrollTop; 
			
				#{rich:element('menutypesmanager')}.getElementsByTagName("div")[0].getElementsByTagName("div")[0].style.left=(posx-panelPosX)+'px';
				#{rich:element('menutypesmanager')}.getElementsByTagName("div")[0].getElementsByTagName("div")[0].style.top=(posy-panelPosY)+'px';
			}
		</script>

		<rich:tree id="typestree" toggleType="ajax" var="item" status="status"
			selectionType="ajax"
			oncomplete="#{rich:component('menutypesmanager')}.hide();if(rightClick==true){#{rich:component('menutypesmanager')}.show();menuTypes();}"
			selectionChangeListener="#{genericTreeBean.change}"
			render="menutypesmanager, edittypesmanager, paneltitletypesmanager">
			<rich:treeModelRecursiveAdaptor roots="#{genericTreeBean.root}"
				nodes="#{genericTreeBean.getChildrens(item)}">
				<!-- 			iconCollapsed="#{genericTreeBean.getCollapsedIcon(item)}" -->
				<!-- 				iconExpanded="#{genericTreeBean.getExpandedIcon(item)}" -->
				<!-- title="#{genericTreeBean.getIconTitle(item)}" -->
				<rich:treeNode iconCollapsed="#{genericTreeBean.getTypeIcon(item)}"
					iconExpanded="#{genericTreeBean.getTypeIcon(item)}"
					onmousedown="if(event.button==2){rightClick = true;posSouris(event);}else{rightClick = false;}"
					title="#{genericTreeBean.getTypeIconTitle(item)}">
					<!-- 				<h:graphicImage value="#{genericTreeBean.getTypeIcon(item)}" -->
					<!-- 					styleClass="middleAlign" -->
					<!-- 					title="#{genericTreeBean.getTypeIconTitle(item)}" /> -->
<!-- 					<a4j:outputPanel layout="block"> -->
<!-- 						<h:outputText value="item"/> -->
						<rich:dragIndicator id="item" acceptClass="accept" rejectClass="reject" draggingClass="default">
					    	#{item}
					    </rich:dragIndicator>
						<rich:dragSource type="std2" dragValue="#{item}"/>
<!-- 						dragIndicator="item"/> -->
<!-- 					</a4j:outputPanel> -->
					<rich:inplaceInput value="#{genericTreeBean.getGenericTreeNodeWrapper(item).value}"
						title="#{genericTreeBean.getTypeIconTitle(item)}" editEvent="dblclick"
						rendered="#{!item.isReadOnly}" activeClass="blackcolor"
						changedClass="blackcolor" styleClass="#{genericTreeBean.getStyle(item)}">
						<a4j:ajax event="change" render="typesmanager" />
					</rich:inplaceInput>
					<h:outputText value="#{item.getValue}"
						title="#{genericTreeBean.getTypeIconTitle(item)}"
						rendered="#{item.isReadOnly}"
						styleClass="#{genericTreeBean.getStyle(item)}" />
				</rich:treeNode>
			</rich:treeModelRecursiveAdaptor>
		</rich:tree>

		<rich:panel id="attributestypesmanager" layout="block">
			<f:facet name="header">
				<h:outputText value="#{msg.attribute}s"/>
			</f:facet>
			
			<a4j:outputPanel layout="block">
				<h:outputText value="int" />
				<rich:dragIndicator id="int" acceptClass="accept" rejectClass="reject" draggingClass="default">
		        	int
		    	</rich:dragIndicator>
				<rich:dragSource type="std" dragValue="int" dragIndicator="int"/>
			</a4j:outputPanel>
			<a4j:outputPanel layout="block">
				<h:outputText value="long" />
				<rich:dragIndicator id="long" acceptClass="accept" rejectClass="reject" draggingClass="default">
			        long
			    </rich:dragIndicator>
				<rich:dragSource type="std" dragValue="long" dragIndicator="long"/>
			</a4j:outputPanel>
			<a4j:outputPanel layout="block">
				<h:outputText value="float" />
				<rich:dragIndicator id="float" acceptClass="accept" rejectClass="reject" draggingClass="default">
			        float
			    </rich:dragIndicator>
				<rich:dragSource type="std" dragValue="float" dragIndicator="float"/>
			</a4j:outputPanel>
			<a4j:outputPanel layout="block">
				<h:outputText value="double" />
				<rich:dragIndicator id="double" acceptClass="accept" rejectClass="reject" draggingClass="default">
			        double
			    </rich:dragIndicator>
				<rich:dragSource type="std" dragValue="double" dragIndicator="double"/>
			</a4j:outputPanel>
			<a4j:outputPanel layout="block">
				<h:outputText value="boolean" />
				<rich:dragIndicator id="boolean" acceptClass="accept" rejectClass="reject" draggingClass="default">
			        boolean
			    </rich:dragIndicator>
				<rich:dragSource type="std" dragValue="boolean" dragIndicator="boolean"/>
			</a4j:outputPanel>
			<a4j:outputPanel layout="block">
				<h:outputText value="string" />
				<rich:dragIndicator id="string" acceptClass="accept" rejectClass="reject" draggingClass="default">
			        string
			    </rich:dragIndicator>
				<rich:dragSource type="std" dragValue="string" dragIndicator="string"/>
			</a4j:outputPanel>
		</rich:panel>
	</rich:panel>

</ui:composition>
