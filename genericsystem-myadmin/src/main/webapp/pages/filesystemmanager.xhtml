<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:gs="http://java.sun.com/jsf/composite/gs">

	<rich:panel id="filesystemmanager" styleClass="fullWidth"
		style="border-width:0;padding:0;">
		<f:facet name="header">
			<h:outputText styleClass="uppercase"
				value="#{msg.file} #{msg.system} #{msg.manager}" />
			<span style="float: right;"> <a4j:outputPanel
					ajaxRendered="true">
					<h:outputText rendered="#{fileSystemBean.fileSelected}"
						value="#{fileSystemBean.fileShortPath}" />
					<h:outputText rendered="#{fileSystemBean.directorySelected}"
						value="#{fileSystemBean.directoryShortPath}" />
				</a4j:outputPanel></span>
		</f:facet>
		<c:catch var="exception">
			<h:panelGrid columns="2" styleClass="fullWidth"
				rowClasses="fullHeight"
				columnClasses="topAlign mediumScroll fullHeight,topAlign fullWidth fullHeight">
				<ui:include src="/pages/directorytree.xhtml" />
				<ui:include src="/pages/editpanel.xhtml" />
			</h:panelGrid>
			<rich:contextMenu target="directorytree" mode="ajax">
				<rich:menuItem
					label="#{msg.add} #{msg.a} #{msg.root} #{msg.directory}"
					oncomplete="#{rich:component('newrootdirectory')}.show()"
					mode="ajax" icon="#{infos.add}" />
			</rich:contextMenu>
		</c:catch>
		<c:if test="#{exception != null}">
			<h:outputText value="#{exception}" />
		</c:if>
	</rich:panel>

	<gs:popupPanel key="createfile"
		title="#{msg.create} #{msg.a} #{msg.file}"
		action="#{fileSystemBean.addFile(popupValue)}" render="directorytree" />
	<gs:popupPanel key="createsubdirectory"
		title="#{msg.create} #{msg.a} #{msg.sub} #{msg.directory}"
		action="#{fileSystemBean.addSubDirectory(popupValue)}"
		render="directorytree" />
	<gs:popupPanel key="newrootdirectory"
		title="#{msg.add} #{msg.a} #{msg.root} #{msg.directory}"
		action="#{fileSystemBean.addRootDirectory(popupValue)}"
		render="directorytree" />

</ui:composition>