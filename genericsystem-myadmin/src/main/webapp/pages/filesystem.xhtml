<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:middleware="http://java.sun.com/jsf/composite/middleware">

	<rich:tree id="tree" toggleType="client" var="item"
		selectionType="ajax" execute="tree" render="editFile"
		selectionChangeListener="#{fileSystemBean.changeFile}"
		onselectionchange="#{rich:component('popupEditFile')}.show()">
		<rich:treeModelRecursiveAdaptor
			roots="#{fileSystemBean.rootDirectories}"
			nodes="#{fileSystemBean.getDirectories(item)}">
			<rich:treeNode>
                    #{item.shortPath}
                </rich:treeNode>
			<rich:treeModelAdaptor nodes="#{fileSystemBean.getFiles(item)}">
				<rich:treeNode>#{item.shortPath}</rich:treeNode>
			</rich:treeModelAdaptor>
		</rich:treeModelRecursiveAdaptor>
	</rich:tree>
	<h:panelGrid id="editFile">
		<middleware:composite_linkslist
			rendered="#{fileSystemBean.renderedEditFile}"
			title="#{msg.create} #{msg.a} #{msg.file} #{msg.of} #{fileSystemBean.getFileSelected().getValue()}"
			generic="#{fileSystemBean.fileSelected}"
			newInputValue="#{fileSystemBean.newFileName}" action="#{fileSystemBean.createFile}" />
	</h:panelGrid>
</ui:composition>